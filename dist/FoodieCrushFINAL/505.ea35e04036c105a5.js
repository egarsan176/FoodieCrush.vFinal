"use strict";(self.webpackChunkFoodieCrushFINAL=self.webpackChunkFoodieCrushFINAL||[]).push([[505],{1505:(G,m,c)=>{c.d(m,{F:()=>Q});var s=c(433),u=c(1135),g=c(4004),f=c(5226),a=c.n(f),e=c(8274),h=c(5800),d=c(162),x=c(1948),v=c(4244),p=c(6895),T=c(3800);function C(i,o){1&i&&(e.TgZ(0,"div",27),e._uU(1," Es obligatorio introducir un t\xedtulo para la Receta "),e.qZA())}function Z(i,o){if(1&i&&(e.TgZ(0,"div",25),e.YNc(1,C,2,0,"div",26),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",null==t.reInfo.recipeName.errors?null:t.reInfo.recipeName.errors.required)}}function b(i,o){1&i&&(e.TgZ(0,"div",27),e._uU(1," Es obligatorio seleccionar una categor\xeda "),e.qZA())}function A(i,o){if(1&i&&(e.TgZ(0,"div",25),e.YNc(1,b,2,0,"div",26),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",null==t.reInfo.category.errors?null:t.reInfo.category.errors.required)}}function I(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"fieldset")(1,"h2",8),e._uU(2,"INFO B\xc1SICA"),e.qZA(),e._UZ(3,"hr"),e.TgZ(4,"div",9)(5,"p"),e._uU(6," En este apartado podr\xe1s introducir el t\xedtulo de la receta, una imagen de \xe9sta y la categor\xeda a la que pertenece. "),e.qZA(),e.TgZ(7,"p",10),e._uU(8,"\xa1Comencemos!"),e.qZA()(),e.TgZ(9,"div",9),e._UZ(10,"app-upload-recipe-file"),e.qZA(),e.TgZ(11,"div",11),e._UZ(12,"input",12),e.TgZ(13,"label",13),e._uU(14,"T\xedtulo de la receta"),e.qZA()(),e.YNc(15,Z,2,1,"div",14),e.TgZ(16,"div",11)(17,"select",15)(18,"option",16),e._uU(19,"Escoger..."),e.qZA(),e.TgZ(20,"option",17),e._uU(21,"Pasta"),e.qZA(),e.TgZ(22,"option",18),e._uU(23,"Arroz"),e.qZA(),e.TgZ(24,"option",19),e._uU(25,"Carne"),e.qZA(),e.TgZ(26,"option",20),e._uU(27,"Pescados"),e.qZA(),e.TgZ(28,"option",21),e._uU(29,"Postres"),e.qZA(),e.TgZ(30,"option",22),e._uU(31,"Otros"),e.qZA()(),e.TgZ(32,"label",23),e._uU(33,"Selecciona una categor\xeda para tu receta"),e.qZA()(),e.YNc(34,A,2,1,"div",14),e.TgZ(35,"button",24),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.next())}),e._uU(36," SIGUIENTE "),e.qZA()()}if(2&i){const t=e.oxw(2);e.xp6(15),e.Q6J("ngIf",t.reInfo_step&&t.recipeDetails.controls.recipeName.errors),e.xp6(19),e.Q6J("ngIf",t.reInfo_step&&t.recipeDetails.controls.category.errors)}}function N(i,o){if(1&i&&(e.TgZ(0,"option",42),e._uU(1),e.qZA()),2&i){const t=o.$implicit;e.s9C("value",t),e.xp6(1),e.hij(" ",t," ")}}function E(i,o){if(1&i&&(e.TgZ(0,"span")(1,"datalist",40),e.YNc(2,N,2,2,"option",41),e.ALo(3,"async"),e.qZA()()),2&i){const t=e.oxw(5);e.xp6(2),e.Q6J("ngForOf",e.lcZ(3,1,t.listFiltered$))}}function M(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",35)(1,"div",36)(2,"input",37),e.NdJ("keyup",function(r){e.CHM(t);const _=e.oxw(4);return e.KtG(_.searchTerm$.next(r.target.value))}),e.qZA()(),e.YNc(3,E,4,3,"span",7),e.TgZ(4,"div",36),e._UZ(5,"input",38),e.qZA(),e.TgZ(6,"div",36)(7,"button",39),e.NdJ("click",function(){const _=e.CHM(t).index,l=e.oxw(4);return e.KtG(l.deleteGroup(_))}),e._uU(8," Borrar "),e.qZA()()()}if(2&i){const t=o.index,n=e.oxw(4);e.Q6J("formGroupName",t),e.xp6(3),e.Q6J("ngIf",null!=n.searchTerm$.getValue())}}function P(i,o){if(1&i&&(e.ynx(0,33),e.YNc(1,M,9,2,"div",34),e.BQk()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.line.controls)}}function U(i,o){1&i&&(e.TgZ(0,"div",27),e._uU(1," Es obligatorio seleccionar los nuevos ingredientes. "),e.qZA())}function F(i,o){if(1&i&&(e.TgZ(0,"div",25),e.YNc(1,U,2,0,"div",26),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.Q6J("ngIf",null==t.line.errors?null:t.line.errors.required)}}function O(i,o){if(1&i&&(e.TgZ(0,"span"),e.YNc(1,F,2,1,"div",14),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.line&&t.ingredientLine.controls.line.errors)}}function R(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"fieldset")(1,"h2",8),e._uU(2,"INGREDIENTES Y CANTIDADES"),e.qZA(),e._UZ(3,"hr"),e.TgZ(4,"div",9)(5,"p"),e._uU(6," Pulsa el bot\xf3n "),e.TgZ(7,"b"),e._uU(8,"A\xf1adir Ingrediente"),e.qZA(),e._uU(9," para introducir los pasos a seguir en tu receta. "),e.qZA()(),e.YNc(10,P,2,1,"ng-container",28),e.TgZ(11,"button",29),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.addNewIngredientLine())}),e._uU(12," A\xf1adir Ingrediente "),e.qZA(),e.TgZ(13,"p",30),e._uU(14,"Cuando hayas finalizado, pulsa "),e.TgZ(15,"b"),e._uU(16,"SIGUIENTE"),e.qZA(),e._uU(17," ."),e.qZA(),e.YNc(18,O,2,1,"span",7),e.TgZ(19,"div",31)(20,"button",32),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.previous())}),e._uU(21," ANTERIOR "),e.qZA(),e.TgZ(22,"button",24),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.next())}),e._uU(23," SIGUIENTE "),e.qZA()()()}if(2&i){const t=e.oxw(2);e.xp6(10),e.Q6J("ngIf",t.line.controls.length>0),e.xp6(8),e.Q6J("ngIf",t.showLine)}}function w(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"div",35)(1,"div",36),e._UZ(2,"input",46),e.qZA(),e.TgZ(3,"div",36)(4,"button",39),e.NdJ("click",function(){const _=e.CHM(t).index,l=e.oxw(4);return e.KtG(l.deleteStep(_))}),e._uU(5," Borrar "),e.qZA()()()}2&i&&e.Q6J("formGroupName",o.index)}function q(i,o){if(1&i&&(e.ynx(0,45),e.YNc(1,w,6,1,"div",34),e.BQk()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",t.method.controls)}}function D(i,o){1&i&&(e.TgZ(0,"div",27),e._uU(1," Es obligatorio seleccionar los nuevos ingredientes. "),e.qZA())}function y(i,o){if(1&i&&(e.TgZ(0,"div",25),e.YNc(1,D,2,0,"div",26),e.qZA()),2&i){const t=e.oxw(4);e.xp6(1),e.Q6J("ngIf",null==t.method.errors?null:t.method.errors.required)}}function J(i,o){if(1&i&&(e.TgZ(0,"span"),e.YNc(1,y,2,1,"div",14),e.qZA()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("ngIf",t.method&&t.recipeMethod.controls.method.errors)}}function k(i,o){if(1&i){const t=e.EpF();e.TgZ(0,"fieldset")(1,"h2",8),e._uU(2,"ELABORACI\xd3N"),e.qZA(),e._UZ(3,"hr"),e.TgZ(4,"div",9)(5,"p"),e._uU(6," Pulsa el bot\xf3n "),e.TgZ(7,"b"),e._uU(8,"Agregar Paso"),e.qZA(),e._uU(9," para introducir los pasos a seguir en tu receta. "),e.qZA()(),e.YNc(10,q,2,1,"ng-container",43),e.TgZ(11,"button",29),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.addNewStep())}),e._uU(12," Agregar paso "),e.qZA(),e.TgZ(13,"p"),e._uU(14,"Cuando hayas finalizado, pulsa "),e.TgZ(15,"b"),e._uU(16,"FINALIZAR"),e.qZA(),e._uU(17," ."),e.qZA(),e.YNc(18,J,2,1,"span",7),e.TgZ(19,"div",31)(20,"button",32),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.previous())}),e._uU(21," ANTERIOR "),e.qZA(),e.TgZ(22,"button",44),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.publicar())}),e._uU(23," FINALIZAR "),e.qZA()()()}if(2&i){const t=e.oxw(2);e.xp6(10),e.Q6J("ngIf",t.method.controls.length>0),e.xp6(8),e.Q6J("ngIf",t.showMethod)}}function L(i,o){if(1&i&&(e.TgZ(0,"div",2)(1,"div",3)(2,"form",4)(3,"ul",5)(4,"li",6),e._uU(5," Detalles de la Receta "),e.qZA(),e.TgZ(6,"li",6),e._uU(7," Ingredientes y Cantidades "),e.qZA(),e.TgZ(8,"li",6),e._uU(9,"Elaboraci\xf3n"),e.qZA()(),e.YNc(10,I,37,2,"fieldset",7),e.qZA(),e.TgZ(11,"form",4),e.YNc(12,R,24,2,"fieldset",7),e.qZA(),e.TgZ(13,"form",4),e.YNc(14,k,24,2,"fieldset",7),e.qZA()()()),2&i){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.recipeDetails),e.xp6(2),e.Q6J("ngClass",t.step>=1?"active ":"inactive"),e.xp6(2),e.Q6J("ngClass",t.step>=2?"active":"inactive"),e.xp6(2),e.Q6J("ngClass",3==t.step?"active":"inactive"),e.xp6(2),e.Q6J("ngIf",1==t.step),e.xp6(1),e.Q6J("formGroup",t.ingredientLine),e.xp6(1),e.Q6J("ngIf",2==t.step),e.xp6(1),e.Q6J("formGroup",t.recipeMethod),e.xp6(1),e.Q6J("ngIf",3==t.step)}}let Q=(()=>{class i{constructor(t,n,r,_,l,Y){this.recipeService=t,this.fb=n,this.fileService=r,this.route=_,this.decodificarToken=l,this.uploadService=Y,this.pending=!0,this.id=localStorage.getItem("id"),this.title="",this.reInfo_step=!1,this.inLine_step=!1,this.meth_step=!1,this.step=1,this.img="",this.showLine=!1,this.showMethod=!1,this.showIng=!1,this.searchTerm$=new u.X(""),this.ingredients=[]}ngOnInit(){this.recipeDetails=this.fb.group({recipeName:["",s.kI.required],category:["",s.kI.required]}),this.ingredientLine=this.fb.group({line:this.fb.array([],s.kI.required)}),this.recipeMethod=this.fb.group({method:this.fb.array([],s.kI.required)}),this.recipeService.getIngredientsFromBD().subscribe({next:t=>{this.showIng=!0,this.ingredients=t},error:t=>{console.log(t)}}),this.filterList()}getFileByRecipe(t){this.fileService.getFileByRecipeID(t).subscribe({next:n=>{null!=n&&(this.img=this.recipeService.getImage(n))},error:n=>{a().fire("Error",n.error.message,"error")}})}addNewIngredientLine(){const t=this.ingredientLine.get("line"),n=this.fb.group({ingredient:[null],amount:[null]});t.push(n)}deleteGroup(t){this.ingredientLine.get("line").removeAt(t)}addNewStep(){const t=this.recipeMethod.get("method"),n=this.fb.group({step:[null]});t.push(n)}deleteStep(t){this.recipeMethod.get("method").removeAt(t)}get reInfo(){return this.recipeDetails.controls}get line(){return this.ingredientLine.controls.line}get method(){return this.recipeMethod.controls.method}next(){if(1==this.step){if(this.reInfo_step=!0,this.recipeDetails.invalid)return;this.step++}else if(2==this.step){if(this.inLine_step=!0,this.ingredientLine.invalid)return void(this.showLine=!0);this.step++}}previous(){this.step--,1==this.step&&(this.inLine_step=!1),2==this.step&&(this.meth_step=!1)}publicar(){if(3==this.step){if(this.meth_step=!0,this.recipeMethod.invalid)return void(this.showMethod=!0);let t=JSON.stringify(localStorage.getItem("token"));this.userDetails=this.decodificarToken.decodeToken(t),this.uploadService.getFileByName().subscribe({next:n=>{this.file=n;const r={id:0,recipeName:this.recipeDetails.controls.recipeName.value.toUpperCase(),method:this.recipeMethod.controls.method.value,category:this.recipeDetails.controls.category.value,ingredientLine:this.ingredientLine.controls.line.value,file:this.file,comments:[],isPending:!0};this.recipeService.publicar(r).subscribe({next:_=>{a().fire({title:"Receta publicada",text:"Su receta se ha publicado con \xe9xito",icon:"info",confirmButtonText:"Aceptar"}).then(l=>{l.isConfirmed&&this.route.navigateByUrl("ADMIN"===this.userDetails?.role?"optionsADMIN/recipesConf":"optionsUser")})},error:_=>{a().fire("Error","No se puede publicar la receta. "+_.error.mensaje,"error")}})},error:n=>{a().fire("Error",n.error.mensaje,"error")}})}}filterList(){this.listFiltered$=this.searchTerm$.pipe((0,g.U)(t=>this.ingredients.filter(n=>n.toLowerCase().indexOf(t.toLowerCase())>=0)))}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(h.v),e.Y36(s.QS),e.Y36(d.J),e.Y36(x.F0),e.Y36(v.N0),e.Y36(d.J))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-recipe-form-template"]],decls:2,vars:1,consts:[[1,"container","py-2"],["class","row",4,"ngIf"],[1,"row"],[1,"col-md-12","col-md-offset-3"],["id","msform",3,"formGroup"],["id","progressbar"],[3,"ngClass"],[4,"ngIf"],[1,"colorYellowP"],[1,"izq"],[1,"text-center"],[1,"form-floating","mb-1"],["type","text","id","floatingInputGrid","placeholder","T\xedtulo de la Receta","name","recipeName","formControlName","recipeName",1,"form-control","pb-1"],["for","floatingInputGrid"],["class","mb-2",4,"ngIf"],["id","floatingSelectGrid","placeholder","Categor\xeda","name","category","formControlName","category",1,"form-select","pb-1","recipeCategory"],["selected",""],["value","1"],["value","2"],["value","3"],["value","4"],["value","5"],["value","6"],["for","floatingSelectGrid"],["type","button","name","next","value","Next",1,"btn","colorPinkP",3,"click"],[1,"mb-2"],["class","err",4,"ngIf"],[1,"err"],["formArrayName","line",4,"ngIf"],[1,"btn","colorPurpleP","mt-2",3,"click"],[1,"my-2"],[1,"mt-2"],["type","button","name","previous","value","Previous",1,"btn","colorGreenP","m-1",3,"click"],["formArrayName","line"],["class","row mb-2 col-12",3,"formGroupName",4,"ngFor","ngForOf"],[1,"row","mb-2","col-12",3,"formGroupName"],[1,"col"],["type","text","formControlName","ingredient","placeholder","Ingrediente","list","ingredients",1,"form-control",3,"keyup"],["type","text","formControlName","amount","placeholder","Cantidad",1,"form-control"],["type","button",1,"btn","btn-outline-danger",3,"click"],["id","ingredients"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["formArrayName","method",4,"ngIf"],["type","submit","name","submit","value","Submit",1,"btn","colorPinkP",3,"click"],["formArrayName","method"],["type","text","formControlName","step","placeholder","Pasos",1,"form-control"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,L,15,9,"div",1),e.qZA()),2&t&&(e.xp6(1),e.Q6J("ngIf",n.showIng))},dependencies:[p.mk,p.sg,p.O5,s._Y,s.YN,s.Kr,s.Fj,s.EJ,s.JJ,s.JL,s.sg,s.u,s.x0,s.CE,T.w,p.Ov],styles:['#msform[_ngcontent-%COMP%]{text-align:center;position:relative;margin-top:30px}#msform[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]{background:white;border:0 none;border-radius:0;box-shadow:0 0 15px 1px #0006;padding:20px 30px;box-sizing:border-box;width:80%;margin:0 10%;position:relative}#msform[_ngcontent-%COMP%]   fieldset[_ngcontent-%COMP%]:not(:first-of-type){display:none}#msform[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], #msform[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:15px;border:1px solid #ccc;border-radius:0;margin-bottom:10px;width:100%;box-sizing:border-box;color:#2c3e50;font-size:18px}.fs-title[_ngcontent-%COMP%]{font-size:18px;text-transform:uppercase;color:#2c3e50;margin-bottom:10px;letter-spacing:2px;font-weight:700}.fs-subtitle[_ngcontent-%COMP%]{font-weight:400;font-size:13px;color:#666;margin-bottom:20px}#progressbar[_ngcontent-%COMP%]{margin-bottom:30px;overflow:hidden;counter-reset:step}#progressbar[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{list-style-type:none;color:#fff;text-transform:uppercase;font-size:9px;width:33.33%;float:left;position:relative;letter-spacing:1px}#progressbar[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:counter(step);counter-increment:step;width:24px;height:24px;line-height:26px;display:block;font-size:12px;color:#333;background:white;border-radius:25px;margin:0 auto 10px}#progressbar[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:after{content:"";width:100%;height:2px;background:white;position:absolute;left:-50%;top:9px;z-index:-1}#progressbar[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child:after{content:none}#progressbar[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]:before, #progressbar[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]:after{background:#c39bd3;color:#fff}#progressbar[_ngcontent-%COMP%]   li.inactive[_ngcontent-%COMP%]:before{background:#f9e79f;color:#000}fieldset[_ngcontent-%COMP%]{-webkit-animation-duration:.25ms;-webkit-animation-name:slidein;-moz-animation-duration:1s;-moz-animation-name:slidein;-o-animation-duration:1s;-o-animation-name:slidein;animation-duration:1s;animation-name:slidein}@keyframes slidein{0%{margin-left:100%;width:300%}to{margin-left:0%;width:100%}}.err[_ngcontent-%COMP%]{color:red}.izq[_ngcontent-%COMP%]{text-align:left}']}),i})()}}]);